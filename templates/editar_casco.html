{% extends 'base.html' %}

{% block title %}Editar Casco - WHIP-HELMETS{% endblock %}

{% block content %}
<div class="container" style="max-width: 900px; background: white; border-radius: 8px; padding: 30px; margin-top: 30px; box-shadow: 0 4px 12px rgba(0,0,0,0.4);">
    <h2 style="color: #333; margin-bottom: 30px;">Editar Casco</h2>
    
    <form method="POST" enctype="multipart/form-data">
        
        <!-- Imagen Principal -->
        <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 25px;">
            <h3 style="color: #333; margin-bottom: 15px;">üì∏ Imagen Principal</h3>
            
            {% if casco.imagen_principal %}
                <div style="position: relative; display: inline-block; margin: 10px 10px 10px 0;">
                    <img src="{{ casco.imagen_principal }}" style="max-width: 200px; border: 3px solid #ddd; border-radius: 8px; display: block;">
                    <form method="POST" action="{{ url_for('eliminar_imagen', casco_id=casco.id, tipo='principal', indice=0) }}" style="display: inline;">
                        <button type="submit" onclick="return confirm('¬øEliminar imagen principal?')" style="position: absolute; top: -8px; right: -8px; background: #dc3545; color: white; border: none; border-radius: 50%; width: 32px; height: 32px; cursor: pointer; font-size: 18px; font-weight: bold; box-shadow: 0 2px 6px rgba(0,0,0,0.2);">‚úï</button>
                    </form>
                </div>
            {% else %}
                <p style="color: #999; font-style: italic;">Sin imagen principal</p>
            {% endif %}
            
            <div style="margin-top: 15px;">
                <label style="display: block; font-weight: 600; color: #333; margin-bottom: 8px;">Cambiar imagen principal:</label>
                <input type="file" name="imagen_principal" accept="image/*" style="padding: 10px; border: 2px dashed #007bff; border-radius: 8px; width: 100%; cursor: pointer; background: #f0f8ff;">
            </div>
        </div>
        
        <!-- Im√°genes Adicionales -->
        <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 25px;">
            <h3 style="color: #333; margin-bottom: 15px;">üñºÔ∏è Im√°genes Adicionales</h3>
            
            {% if casco.imagenes_adicionales %}
                <div style="display: flex; flex-wrap: wrap; gap: 15px; margin-top: 15px;">
                    {% for imagen in casco.imagenes_adicionales.split(',') %}
                        <div style="position: relative; display: inline-block;">
                            <img src="{{ imagen }}" style="max-width: 150px; border: 3px solid #ddd; border-radius: 8px; display: block;">
                            <form method="POST" action="{{ url_for('eliminar_imagen', casco_id=casco.id, tipo='adicional', indice=loop.index0) }}" style="display: inline;">
                                <button type="submit" onclick="return confirm('¬øEliminar esta imagen?')" style="position: absolute; top: -8px; right: -8px; background: #dc3545; color: white; border: none; border-radius: 50%; width: 32px; height: 32px; cursor: pointer; font-size: 18px; font-weight: bold; box-shadow: 0 2px 6px rgba(0,0,0,0.2);">‚úï</button>
                            </form>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <p style="color: #999; font-style: italic;">Sin im√°genes adicionales</p>
            {% endif %}
            
            <div style="margin-top: 15px;">
                <label style="display: block; font-weight: 600; color: #333; margin-bottom: 8px;">Agregar m√°s im√°genes:</label>
                <input type="file" name="imagenes_adicionales" accept="image/*" multiple style="padding: 10px; border: 2px dashed #007bff; border-radius: 8px; width: 100%; cursor: pointer; background: #f0f8ff;">
            </div>
        </div>
        
        <!-- Datos del Casco -->
        <div style="margin-bottom: 20px;">
            <label style="display: block; font-weight: 600; color: #333; margin-bottom: 8px;">Nombre del Casco *</label>
            <input type="text" name="nombre_modelo" value="{{ casco.nombre }}" required placeholder="Ej: Casco Integral Racing" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 15px; box-sizing: border-box;">
        </div>
        
        <div style="margin-bottom: 20px;">
            <label style="display: block; font-weight: 600; color: #333; margin-bottom: 8px;">Marca *</label>
            <input type="text" name="marca" value="{{ casco.marca }}" required placeholder="Ej: Hawk, LS2, AGV" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 15px; box-sizing: border-box;">
        </div>
        
        <div style="margin-bottom: 20px;">
            <label style="display: block; font-weight: 600; color: #333; margin-bottom: 8px;">Precio *</label>
            <input type="number" step="0.01" name="precio" value="{{ casco.precio }}" required placeholder="0.00" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 15px; box-sizing: border-box;">
        </div>
        
        <div style="margin-bottom: 20px;">
            <label style="display: block; font-weight: 600; color: #333; margin-bottom: 8px;">Descripci√≥n</label>
            <textarea name="descripcion" placeholder="Descripci√≥n detallada del casco..." style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 15px; resize: vertical; min-height: 100px; box-sizing: border-box;">{{ casco.descripcion or '' }}</textarea>
        </div>
        
        <div style="margin-bottom: 20px;">
            <label style="display: block; font-weight: 600; color: #333; margin-bottom: 8px;">Link de Instagram</label>
            <input type="url" name="instagram_url" value="{{ casco.instagram_url or '' }}" placeholder="https://instagram.com/p/ABC123..." style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 15px; box-sizing: border-box;">
        </div>
        
        <div style="margin-bottom: 30px;">
            <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                <input type="checkbox" name="disponible" id="disponible" {% if casco.disponible %}checked{% endif %} style="width: 20px; height: 20px; cursor: pointer;">
                <span style="font-weight: 600; color: #333;">‚úÖ Disponible para la venta</span>
            </label>
        </div>
        
<!-- Agregar campos faltantes -->
            <div style="margin-bottom: 20px;">
                <label style="display: block; font-weight: 600; color: #333; margin-bottom: 8px;">Tipo *</label>
                <input type="text" name="tipo" value="{{ casco.tipo or '' }}" placeholder="Ej: Integral, Abierto" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 15px; box-sizing: border-box;">
            </div>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; font-weight: 600; color: #333; margin-bottom: 8px;">Condici√≥n *</label>
                <select name="condicion" required style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 15px; box-sizing: border-box;">
                    <option value="Nuevo" {% if casco.condicion == 'Nuevo' %}selected{% endif %}>Nuevo</option>
                    <option value="Usado" {% if casco.condicion == 'Usado' %}selected{% endif %}>Usado</option>
                </select>
            </div>
            <div style="margin-bottom: 20px;">
                <label style="display: block; font-weight: 600; color: #333; margin-bottom: 8px;">Talle</label>
                <input type="text" name="talle" value="{{ casco.talle or '' }}" placeholder="Ej: L, M, S" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 15px; box-sizing: border-box;">
            </div>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; font-weight: 600; color: #333; margin-bottom: 8px;">Color</label>
                <input type="text" name="color" value="{{ casco.color or '' }}" placeholder="Ej: Negro, Rojo" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 15px; box-sizing: border-box;">
            </div>

            <div style="margin-bottom: 30px;">
                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                    <input type="checkbox" name="destacado" id="destacado" {% if casco.destacado %}checked{% endif %} style="width: 20px; height: 20px; cursor: pointer;">
                    <span style="font-weight: 600; color: #333;">‚≠ê Marcar como destacado</span>
                </label>
        </div>

        <div style="display: flex; gap: 15px;">
            <button type="submit" style="background: #28a745; color: white; padding: 14px 35px; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: 600;">üíæ Guardar Cambios</button>
            <a href="{{ url_for('admin_panel') }}" style="background: #6c757d; color: white; padding: 14px 35px; border: none; border-radius: 8px; text-decoration: none; font-size: 16px; font-weight: 600; display: inline-block;">‚ùå Cancelar</a>
        </div>
    </form>
</div>
{% endblock %}

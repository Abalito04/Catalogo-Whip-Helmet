{% extends 'base.html' %}

{% block content %}
<div style="max-width: 800px; margin: 50px auto; padding: 20px;">
    <h2>Editar Casco</h2>
    
    <form method="POST" enctype="multipart/form-data">
        
        <!-- Imagen Principal Actual -->
        <div style="margin-bottom: 20px;">
            <label style="font-weight: bold;">Imagen Principal Actual:</label>
            {% if casco.imagen_principal_url %}
                <div style="position: relative; display: inline-block; margin-top: 10px;">
                    <img src="{{ casco.imagen_principal_url }}" style="max-width: 200px; border: 2px solid #ddd; border-radius: 8px;">
                    <form method="POST" action="{{ url_for('eliminar_imagen', casco_id=casco.id, tipo='principal', indice=0) }}" style="display: inline;">
                        <button type="submit" onclick="return confirm('¿Eliminar imagen principal?')" style="position: absolute; top: 5px; right: 5px; background: red; color: white; border: none; border-radius: 50%; width: 30px; height: 30px; cursor: pointer;">✕</button>
                    </form>
                </div>
            {% else %}
                <p style="color: #999;">Sin imagen principal</p>
            {% endif %}
            
            <label style="display: block; margin-top: 15px;">Cambiar Imagen Principal:</label>
            <input type="file" name="imagen_principal" accept="image/*">
        </div>
        
        <!-- Imágenes Adicionales Actuales -->
        <div style="margin-bottom: 20px;">
            <label style="font-weight: bold;">Imágenes Adicionales Actuales:</label>
            {% if casco.imagenes_adicionales_url %}
                <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px;">
                    {% for imagen in casco.imagenes_adicionales_url.split(',') %}
                        <div style="position: relative;">
                            <img src="{{ imagen }}" style="max-width: 150px; border: 2px solid #ddd; border-radius: 8px;">
                            <form method="POST" action="{{ url_for('eliminar_imagen', casco_id=casco.id, tipo='adicional', indice=loop.index0) }}" style="display: inline;">
                                <button type="submit" onclick="return confirm('¿Eliminar esta imagen?')" style="position: absolute; top: 5px; right: 5px; background: red; color: white; border: none; border-radius: 50%; width: 30px; height: 30px; cursor: pointer;">✕</button>
                            </form>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <p style="color: #999;">Sin imágenes adicionales</p>
            {% endif %}
            
            <label style="display: block; margin-top: 15px;">Agregar Más Imágenes:</label>
            <input type="file" name="imagenes_adicionales" accept="image/*" multiple>
        </div>
        
        <!-- Resto de campos -->
        <div style="margin-bottom: 15px;">
            <label>Nombre:</label>
            <input type="text" name="nombre" value="{{ casco.nombre }}" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
        </div>
        
        <div style="margin-bottom: 15px;">
            <label>Marca:</label>
            <input type="text" name="marca" value="{{ casco.marca }}" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
        </div>
        
        <div style="margin-bottom: 15px;">
            <label>Precio:</label>
            <input type="number" step="0.01" name="precio" value="{{ casco.precio }}" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
        </div>
        
        <div style="margin-bottom: 15px;">
            <label>Descripción:</label>
            <textarea name="descripcion" rows="4" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">{{ casco.descripcion or '' }}</textarea>
        </div>
        
        <div style="margin-bottom: 15px;">
            <label>Instagram URL:</label>
            <input type="url" name="instagram_url" value="{{ casco.instagram_url or '' }}" placeholder="https://instagram.com/p/ABC123..." style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
        </div>
        
        <div style="margin-bottom: 15px;">
            <label>
                <input type="checkbox" name="disponible" {% if casco.disponible %}checked{% endif %}>
                Disponible para la venta
            </label>
        </div>
        
        <button type="submit" style="background: #007bff; color: white; padding: 12px 30px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px;">Guardar Cambios</button>
        <a href="{{ url_for('admin_panel') }}" style="margin-left: 15px; color: #666;">Cancelar</a>
    </form>
</div>
{% endblock %}

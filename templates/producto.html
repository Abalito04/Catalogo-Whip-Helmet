{% extends "base.html" %}

{% block title %}{{ casco.marca }} {{ casco.nombre_modelo }} - WHIP-HELMETS{% endblock %}

{% block content %}

<div class="producto-detalle">
    <!-- Breadcrumb -->
    <nav class="breadcrumb">
        <a href="{{ url_for('index') }}">‚Üê Volver al cat√°logo</a>
    </nav>

            <!-- Galer√≠a de im√°genes - REESTRUCTURADA -->
        <div class="producto-galeria">
            <!-- Imagen Principal -->
            <div class="imagen-principal" onclick="abrirLightbox()">
                {% if casco.imagen_principal %}
                <img id="imagen-main" src="{{ casco.imagen_principal }}" 
                     alt="{{ casco.marca }} {{ casco.nombre_modelo }}">
                {% else %}
                <div class="sin-imagen-grande">Sin imagen disponible</div>
                {% endif %}
            </div>

            <!-- Miniaturas -->
            {% if casco.imagenes_adicionales %}
            <div class="imagenes-thumbnails">
                <img class="thumbnail active" 
                     src="{{ casco.imagen_principal }}"
                     onclick="cambiarImagen(this.src)"
                     alt="Vista 1">
                
                {% for img in casco.get_imagenes_lista() %}
                <img class="thumbnail" 
                     src="{{ img }}"
                     onclick="cambiarImagen(this.src)"
                     alt="Vista {{ loop.index + 1 }}">
                {% endfor %}
            </div>
            {% endif %}

            <!-- Bot√≥n Instagram -->
            {% if casco.instagram_url %}
            <a href="{{ casco.instagram_url }}" target="_blank" class="btn-instagram-post-galeria">
                üì∏ Ver publicaci√≥n en Instagram
            </a>
            {% endif %}
        </div>

<!-- Lightbox FUERA de la galer√≠a -->
<div id="lightbox" class="lightbox" onclick="cerrarLightbox(event)">
    <span class="lightbox-close" onclick="cerrarLightbox(event)">&times;</span>
    
    <button class="lightbox-nav lightbox-prev" onclick="event.stopPropagation(); cambiarImagenLightbox(-1)">
        ‚ùÆ
    </button>
    
    <img class="lightbox-content" id="lightbox-img" alt="Imagen ampliada">
    
    <button class="lightbox-nav lightbox-next" onclick="event.stopPropagation(); cambiarImagenLightbox(1)">
        ‚ùØ
    </button>
    
    <div class="lightbox-counter" id="lightbox-counter"></div>
</div>


            {% if casco.imagenes_adicionales %}
            <div class="imagenes-thumbnails">
                <!-- Thumbnail de la imagen principal -->
                <img class="thumbnail active" 
                     src="{{ casco.imagen_principal }}"
                     onclick="cambiarImagen(this.src)"
                     alt="Frontal">
                
                <!-- Thumbnails de im√°genes adicionales -->
                {% for img in casco.get_imagenes_lista() %}
                <img class="thumbnail" 
                     src="{{ img }}"
                     onclick="cambiarImagen(this.src)"
                     alt="Vista adicional">
                {% endfor %}
            </div>
            {% endif %}

            <!-- BOT√ìN VER PUBLICACI√ìN - AC√Å EN LA GALER√çA -->
            {% if casco.instagram_url %}
            <a href="{{ casco.instagram_url }}" target="_blank" class="btn-instagram-post-galeria">
                üì∏ Ver publicaci√≥n en Instagram
            </a>
            {% endif %}

        </div>

        <!-- Informaci√≥n del producto -->
        <div class="producto-info">
            <!-- Badges -->
            <div class="badges-container">
                <span class="badge-grande badge-{{ casco.condicion }}">
                    {{ casco.condicion|upper }}
                </span>
                {% if casco.destacado %}
                <span class="badge-grande badge-destacado">‚≠ê DESTACADO</span>
                {% endif %}
            </div>

            <!-- T√≠tulo y marca -->
            <h1>{{ casco.marca }}</h1>
            <h2 class="modelo-titulo">{{ casco.nombre_modelo }}</h2>

            <!-- Precio -->
            <p class="precio-grande">${{ "%.2f"|format(casco.precio) }}</p>

            <!-- Especificaciones -->
            <div class="especificaciones">
                <h3>Especificaciones</h3>
                <ul>
                    {% if casco.tipo %}
                    <li><strong>Tipo:</strong> {{ casco.tipo|capitalize }}</li>
                    {% endif %}
                    
                    {% if casco.talle %}
                    <li><strong>Talle:</strong> {{ casco.talle }}</li>
                    {% endif %}
                    
                    {% if casco.color %}
                    <li><strong>Color:</strong> {{ casco.color }}</li>
                    {% endif %}
                    
                    <li><strong>Condici√≥n:</strong> {{ casco.condicion|capitalize }}</li>
                    <li><strong>Disponibilidad:</strong> 
                        {% if casco.disponible %}
                        <span class="disponible">‚úì Disponible</span>
                        {% else %}
                        <span class="no-disponible">‚úó No disponible</span>
                        {% endif %}
                    </li>
                </ul>
            </div>

            <!-- Descripci√≥n -->
            {% if casco.descripcion %}
            <div class="descripcion">
                <h3>Descripci√≥n</h3>
                <p>{{ casco.descripcion }}</p>
            </div>
            {% endif %}

            <!-- BOTONES SECUNDARIOS - AC√Å EN PRODUCTO-INFO -->
            <div class="botones-info">
                <a href="https://www.instagram.com/whip.helmets/" target="_blank" class="btn-instagram">
                    üì∏ Visitar nuestro Instagram
                </a>
                
                <a href="https://wa.me/542954544001?text=Hola!%20Me%20interesa%20el%20casco%20{{ casco.marca }}%20{{ casco.nombre_modelo }}" 
                   target="_blank" class="btn-whatsapp">
                    üí¨ Consultar por WhatsApp
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/producto.js') }}"></script>
{% endblock %}

